{
  "name": "Daytona.io Dev Container",
  "image": "mcr.microsoft.com/vscode/devcontainers/base:ubuntu", // You can change the base image if needed
  "features": {
    "docker-in-docker": "latest",
    "node": "lts"
  },
  "extensions": [
    "ms-python.python",
    "esbenp.prettier-vscode",
    "dbaeumer.vscode-eslint",
    "eamodio.gitlens",
    "ms-azuretools.vscode-docker"
  ],
  "settings": {
    "python.pythonPath": "/workspace/backend/venv/bin/python",
    "editor.formatOnSave": true,
    "eslint.validate": [
      "javascript",
      "javascriptreact",
      "typescript",
      "typescriptreact"
    ],
    "terminal.integrated.shell.linux": "/bin/bash"
  },
  "mounts": [
    "source=${localWorkspaceFolder}/frontend,target=/workspace/frontend,type=bind,consistency=cached",
    "source=${localWorkspaceFolder}/backend,target=/workspace/backend,type=bind,consistency=cached"
  ],
  "forwardPorts": [3000, 8000, 7700],
  "workspaceFolder": "/workspace",
  "postCreateCommand": "sudo apt-get update && sudo apt-get install -y python3 python3-pip python3-venv && python3 -m venv /workspace/backend/venv && ln -s /workspace/backend/venv/bin/python /workspace/backend/venv/bin/python3 && /workspace/backend/venv/bin/pip install -r /workspace/backend/requirements.txt && cd /workspace/frontend && npm install",
  "postStartCommand": "if [ ! -d /workspace/backend/venv ]; then python3 -m venv /workspace/backend/venv && /workspace/backend/venv/bin/pip install -r /workspace/backend/requirements.txt; fi && if docker ps -a --filter name=meilisearch --format '{{.Names}}' | grep -w meilisearch; then docker start meilisearch || true; else docker run -d --name meilisearch -p 7700:7700 getmeili/meilisearch:v1.2; fi && /workspace/backend/venv/bin/uvicorn backend.app.main:app --host 0.0.0.0 --port 8000 & npm run dev --prefix /workspace/frontend",
  "containerUser": "root",
  "shutdownAction": "none"
}
